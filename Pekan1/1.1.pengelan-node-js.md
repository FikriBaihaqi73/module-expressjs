# Mengenal Node JS

Sebagaimana yang telah kita ketahui javascript merupakan bahasa pemrograman disisi client yang hanya bisa berjalan pada web browser / client side. Pada browser telah disematkan sebuah engine yang berfungsi menjalankan kode javascript.

Serangkat dari konsep tersebut, menginspirasi Ryan Dahl pada tahun 2009 untuk menciptakan sebuah tools yang memungkinkan kita menjalankan javascript di luar browser. Tools inilah yang dinamakan NodeJS.

Engine yang digunakan oleh NodeJS untuk menjalankan javascript di luar browser adalah V8 buatan Google. Engine V8 yang dibuat dengan menggunakan bahasa C++ ini sebenarnya merupakan engine yang juga digunakan pada browser Google Chrome. Dengan cara ini maka kemudian Javascript bisa dijalankan pada platform apapun.

Bisa dikatakan NodeJS bukan tergolong bahasa pemrograman, lebih tepatnya adalah runtime environment untuk menjalankan kode Javascript.

Bagi kita seorang programmer Javascript yang awalnya hanya bisa bermain di ranah frontend, kehadiran NodeJS ini tentu sangat menggembirakan. Hal ini berarti bahwa untuk membuat kode aplikasi backend bisa juga dengan menggunakan bahasa yang sama yaitu Javascript.

## Membuat Projek Baru Dengan Node JS

Untuk membuat projek aplikasi baru berbasis Node JS kita bisa gunakan perintah `npm init`, dimana perintah ini akan menampilkan dialog interaktif tentang profil proyek yang akan kita buat hingga kemudian profil tersebut disimpan dalam file bernama `package.json`.

Note : Sebelum itu pastikan di lokal komputer kalian sudah terinstall node js dan npm, jika belum, silahkan instalasi terlebih dahulu.

Setelah menjalankan perintah `npm init` kita akan dibuatkan file baru dengan nama `package.json` yang berisikan code berikut :

```json
{
  "name": "nama-projek",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}
```

Selain profil dari projek aplikasi, file `package.json` ini juga berisi file mount point atau yang pertama kali akan dijalankan ketika projek ini dijalankan yaitu pada key `main` yang berisi `index.js`. Di samping itu kita bisa definisikan juga perintah yang nantinya bisa kita jalankan pada terminal yaitu pada key `scripts`. Daftar modules yang kita gunakan atau perlukan pada proyek ini juga didefinisikan pada file ini yaitu key `dependencies`, saat ini key ini tidak ada karena kita belum menginstal module apapun.

## Membuat Hello World

Untuk menampilkan teks hello world menggunakan Node JS, caranya adalah dengan membuat file `index.js` / yang lain nya dengan format js yang berisikan kode sebagai berikut :

```javascript
const http = require('http');

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/plain');
  res.write('Hello, world!');
  res.end();
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Kita perlu menginisialisasi module `http` bawaan NodeJS untuk menjalankan sebuah web server. Module `http` memiliki dua method atau fungsi utama yaitu `createServer()` untuk membuat server baru dan `listen()` untuk mendefinisikan port dari web server yang dalam hal ini menggunakan port 3000.

Adapun fungsi `createServer` memiliki argumen parameter berupa fungsi callback. Fungsi ini juga memiliki setidaknya dua argumen yaitu `req` (request) dan `res` (response). Argumen `req` untuk menangkap request dari luar, sedangkan argumen `res` untuk merespon request ke luar.

Pada contoh diatas kita gunakan properti `statusCode` untuk mengidentifikasi bahwa kode responnya 200 atau sukses, method `setHeader` buat mengatur header dari respon yang akan dikirimkan yaitu detail headernya atau dalam hal ini jenis kontennya berupa teks biasa.

Adapun method `write()` digunakan untuk menampilkan konten responnya yang pada contoh ini berisi teks `Hello world!`. Sedangkan method `end()` untuk mengakhiri respon.

## Running Project NodeJS

Sebelumnya kita telah menuliskan kode pada file `index.js` untuk menampilkan hello world, maka saatnya kita menjalankannya. Sekarang silahkan buka terminal pada lalu jalankan perintah `node index.js`

Jika tidak ada error maka pada terminal tidak muncul info apapun, namun sebenarnya server aplikasi hello world telah dijalankan. Oleh karena itu pada browser silakan akses alamat URL: `http://localhost:3000`

Atau kita bisa akses alamat URL tersebut menggunakan Postman yang mana secara default method dari URL tersebut adalah GET.

Kembali ke kodingan `index.js`, dimana kita bisa menambahkan argumen pada method `listen` yang sebelumnya hanya berisi kode port, dimana kita bisa menambahkan argumen kedua berupa hostname atau alamat IP server dan argumen ketiga berupa callback yang dalam hal ini bisa digunakan untuk menampilkan informasi server. Perhatikan kode berikut:

```javascript
const http = require('http');

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/plain');
  res.write('Hello, world!');
  res.end();
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Jika kita jalankan pada terminal maka hasilnya akan menampilkan sebagai berikut:

```bash
Server berjalan pada http://localhost:3000
```

## Membuat Module

Tanpa kita sadari sebenarnya kita telah menggunakan module Built-in dari NodeJS yaitu `http` yang berfungsi untuk membuat web server. kita ketahui bahwa module merupakan suatu tools yang digunakan untuk menambah fungsionalitas dari NodeJS, jadi tidak bisa berdiri sendiri. Kedua, kodenya bisa dibuat dengan menggunakan bahasa pemrograman C/C++ dan juga Javascript. Ketiga, untuk menggunakannya kita bisa gunakan keyword `require()` pada kode NodeJS kita.

Baik, untuk lebih jelasnya, kita mencoba membuat sebuah module sederhana. Module ini berfungsi menampilkan teks Hello world! dan kita kasih nama module `helloWorld`.

buat file module `helloWorld.js` pada direktori projek kita sebelumnya. Kemudian tulis kodenya sebagai berikut:

```javascript
exports.hello = () => {
  return 'Hello, world!';
};
```

Sesederhana ini, pada kode di atas kita mengekspor konten teks `Hello world!` dengan menggunakan keyword `exports`. Kenapa di ekspor? ya, supaya bisa digunakan oleh module lain atau kode aplikasi Node JS kita melalui keyword `require`.

Kemudian pada file `index.js` kita bisa gunakan keyword `require` untuk menggunakan module ini:

```javascript
const http = require('http');
const helloWorld = require('./helloWorld'); // Menggunakan module lokal

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/plain');
  res.write(helloWorld.hello()); // Menggunakan fungsi dari module helloWorld
  res.end();
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Maka ketika dijalankan pada browser atau Postman akan menampilkan teks `Hello world!`

## NPM Module

Sebelumnya kita telah mencoba menggunakan built-in module atau module bawaan NodeJS, kemudian kita juga mencoba membuat module sendiri, maka berikutnya kita akan mengenal npm modules.

Npm modules merupakan module NodeJS yang dibuat oleh komunitas dan dihosting pada repository `https://www.npmjs.com`. Kita bisa menggunakan npm modules pada aplikasi kita dengan sebelumnya mendownload ke lokal projek kita.

Untuk mendownload npm modules kita bisa menggunakan tools `npm` melalui perintah:

```bash
npm install nama_module
```

Sebagai contoh, kita akan menginstal sebuah modul yang cukup populer yaitu `moment`. Module ini berfungsi melakukan formatting terhadap data tanggal dan waktu.

```bash
npm install moment
```

Nah, setelah melakukan instalasi, npm akan menambahkan dependencies library pada file `package.json`

```json
{
  "name": "nama-projek",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "moment": "^2.29.1"
  }
}
```

Serta membuat file `package-lock.json` yang berisi detail pustaka yang didownload beserta dependensinya.

Disamping itu, juga akan bertambah sebuah folder bernama `node_modules` yang berisi file pustaka yang diinstal pada projek kita, atau dalam hal ini `momentjs`.

Untuk menggunakannya, secara prinsip sama dengan menggunakan modules lain.

```javascript
const http = require('http');
const moment = require('moment'); // Menggunakan module moment

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/plain');
  res.write(`Hello, world! Waktu saat ini: ${moment().format('YYYY-MM-DD HH:mm:ss')}`);
  res.end();
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Apabila dijalankan maka akan menampilkan respon yang kurang lebih sebagai berikut:

```
Hello, world! Waktu saat ini: 2025-12-01 10:00:00
```

Note : untuk menghapus module, gunakan perintah `npm uninstall nama_module`

## Menambahkan Scripts

Pada bagian sebelumnya telah dijelaskan bahwa pada file `package.json` terdapat key `scripts`. Bagian ini digunakan untuk mendaftarkan perintah pada npm sekaligus me-alias-kannya. Format perintahnya adalah `npm run “nama_alias”`.

Perhatikan contoh berikut, dimana kita akan mendaftarkan perintah `node index` dengan alias `start` pada file `package.json`.

```json
{
  "name": "nama-projek",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "moment": "^2.29.1"
  }
}
```

Sekarang, untuk menjalankan aplikasi, kita bisa gunakan perintah:

```bash
npm run start
```

## Menampilkan Response Berformat JSON

Umumnya web service akan mengembalikan response berformat JSON. Hal ini bisa juga kita terapkan pada kode kita sebelumnya, yaitu dengan terlebih dahulu membungkus response JSON dengan fungsi `JSON.stringify()` serta mengubah content type pada header menjadi `text/json`.

Perhatikan potongan kode berikut:

```javascript
const http = require('http');

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'application/json'); // Mengubah Content-Type menjadi application/json
  res.end(JSON.stringify({
    message: 'Hello, world!',
    timestamp: new Date().toISOString()
  })); // Mengembalikan response JSON
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Apabila kita jalankan pada Postman maka hasilnya kurang lebih sebagai berikut:

```json
{
  "message": "Hello, world!",
  "timestamp": "2025-12-01T03:00:00.000Z"
}
```

## Routing

Pada contoh sebelumnya, response yang dikembalikan oleh web service kita hanya satu jenis response meskipun kita mengakses dengan URL apapun. Maka disini kita juga bisa membedakan response berdasarkan URLnya, atau istilah ini disebut sebagai routing.

Misal ketika routenya `/` maka konten yang muncul `data apa yang kamu perlukan?`, jika route `/categories` maka konten yang muncul adalah `data kategori`. Bagaimana melakukan hal ini?

Untuk melakukannya kita akan mengandalkan argumen `req` atau `request` yang ada pada fungsi callback di method `createServer((req, res)=>{})`.

Argumen `req` memiliki properti `url` yang akan menampilkan routing saat ini, silahkan mencobanya menggunakan kode berikut:

```javascript
const http = require('http');

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/plain');
  res.end(req.url); // Menampilkan URL yang diakses
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Maka ketika kita mengakses menggunakan URL `http://localhost:3000/` maka responnya adalah `/`, jika URL `http://localhost:3000/categories`, maka respon yang ditampilkan adalah `/categories`, dst.

Dengan berbekal hal ini maka kita bisa menggunakan logika `if` untuk menampilkan respon sesuai dengan routing yang diberikan.

```javascript
const http = require('http');

const requestListener = (req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/plain');

  if (req.url === '/') {
    res.end('Data apa yang kamu perlukan?');
  } else if (req.url === '/categories') {
    res.end('Data kategori');
  } else {
    res.statusCode = 404;
    res.end('Halaman tidak ditemukan!');
  }
};

const server = http.createServer(requestListener);

const port = 3000;
const host = 'localhost';

server.listen(port, host, () => {
  console.log(`Server berjalan pada http://${host}:${port}`);
});
```

Dengan cara ini maka ketika URLnya `/categories` berikut ini respon yang ditampilkan adalah data kategori, demikian seterusnya.

## Framework NodeJS

Fitur-fitur yang dibutuhkan untuk membuat web service secara standar diantaranya:

*   Advanced routing
*   Middleware
*   Validation
*   Authentication
*   Database Interaction
*   Testing

Sebenarnya kita bisa saja meramu semua fitur tersebut dari nol serta menginstalasi module-module yang dibutuhkan sebagaimana yang telah dicontohkan sebagian pada materi sebelumnya. Namun alangkah baiknya kita menggunakan framework atau kerangka kerja yang merupakan best practice dan telah teruji di dunia industri selain tentu akan mempercepat kodingan kita.

Ada banyak framework berbasis NodeJS yang tersedia, diantaranya:

*   expressjs
*   koajs
*   sailsjs
*   loopback
*   hapijs
*   nestjs
*   adonisjs

Masing-masing tentu memiliki kelebihan dan kekurangan sendiri-sendiri maka sesuaikan saja dengan kebutuhan projek aplikasi yang hendak kita bangun.

Sebagai gambaran, framework Express JS misalnya, merupakan framework Node JS yang paling populer, banyak sekali tutorial menggunakannya. Karena cukup generik maka framework ini juga banyak dijadikan sebagai dasar dari framework lain misalnya Sails, Loopback, KoaJS, NestJS, dll.

## Kesimpulan

NodeJS merupakan runtime environment yang berjalan di atas engine V8 milik Google (engine yang sama di belakang browser Chrome) untuk menjalankan kode Javascript di luar browser. Dengan NodeJS kita bisa membangun berbagai jenis aplikasi diantaranya: fullstack web, web service dan web socket.

NodeJS memiliki pustaka-pustaka yang dikenal dengan istilah module. Module-module tersebut di hosting pada repositori publik yaitu `npmjs`. Kita bisa menginstalnya pada projek kita dengan bantuan tools berbasis terminal yang bernama `NPM`.
